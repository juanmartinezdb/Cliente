<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .lectivo {
            background-color: green;
        }

        .festivo {
            background-color: brown;
        }

        .finde {
            background-color: burlywood;
        }

        .out {
            background-color: grey;
        }
    </style>
</head>

<body>
    <p>Quedan <span class="restantes"></span> para que acabe el curso</p>
    <section class="calendario">

    </section>
</body>
<script>
    // 1nov, 6,9,23,24,25,26,27,30,31 dic,1,2,3,6,7 ene,24,25,26,27,28 feb,14abril fin (festivos)
    const mes = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'augost', 'september', 'october', 'november', 'december'];
    let festivos = [
        new Date("2024-11-1"),
        new Date("2024-12-6"),
        new Date("2024-12-9"),
        new Date("2024-12-23"),
        new Date("2024-12-24"),
        new Date("2024-12-25"),
        new Date("2024-12-26"),
        new Date("2024-12-27"),
        new Date("2024-12-30"),
        new Date("2024-12-31"),
        new Date("2025-1-1"),
        new Date("2025-1-2"),
        new Date("2025-1-3"),
        new Date("2025-1-6"),
        new Date("2025-1-7"),
        new Date("2025-2-24"),
        new Date("2025-2-25"),
        new Date("2025-2-26"),
        new Date("2025-2-27"),
        new Date("2025-2-28")
    ]; //se podria haber hecho con un map y me ahorraba un ratillo (la inspiración llegó tarde)

    let diaSemana = ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"];

    let hoy = new Date();
    let fin = new Date("2025-4-11");
    let cont = 0;
    let contaCelda = 0;
    let tablaLectivos = () => {
        let calendario = document.querySelector(".calendario");
        let test = new Date(hoy.getFullYear(), hoy.getMonth(), 1); //para empezar cada mes en dia 1
        while (test <= fin) {

            //creamos un elemento, le asociamos el contenido, y appendChild para que se grabe en calendario.
            let cabeceraMes = document.createElement('h2');
            cabeceraMes.textContent = mes[test.getMonth() + 1];
            calendario.appendChild(cabeceraMes);

            //Cada mes, una tabla:
            //declaro la tabla y la cabecera;
            let tabla = document.createElement('table');
            let cabeza = document.createElement('thead');
            let trCabeza = document.createElement('tr');


            //al tr de cabeza le metemos cada dia de la semana.
            for (let i = 0; i < 7; i++) {
                let th = document.createElement('th');
                th.textContent = diaSemana[i];
                trCabeza.appendChild(th);
            }
            cabeza.appendChild(trCabeza); //como una muñeca rusa, vamos creando y guardando
            calendario.appendChild(cabeza);

            let cuerpo = document.createElement('tbody');
            let tr = document.createElement('tr');

            //calculamos los huecos del principio de mes sin nada
            let diaSem1 = test.getDay();
            let huecos = (diaSem1 === 0) ? 6 : diaSem1 - 1; //si es domingo va al final, si no como el lunes es 1 los que
            //sobren se meten de huecos vacios
            for (let i = 0; i < huecos; i++) {
                let td = document.createElement('td');
                tr.appendChild(td);
                contaCelda++;
            }
            //repasar apuntes HOLA MUNDO de ultimate javascript, suma de dias y dias negativos dia 0.
            let numDiasMes = new Date(test.getFullYear(), test.getMonth() + 1, test.getDate() - 1).getDate();

            for (let dia = 1; dia <= numDiasMes; dia++) {
                let fechaDia = new Date(test.getFullYear(), test.getMonth(), dia);
                //contamos las celdas y al llegar a 7 nuevo tr para cambiar de semana.
                if (contaCelda == 7) {
                    cuerpo.appendChild(tr);
                    tr = document.createElement('tr');
                }
                let td = document.createElement('td');
                td.textContent = dia + '\n' + diaSemana[fechaDia.getDay];

                //marcamos segun el dia
                if (fechaDia >= hoy && fechaDia <= fin) {
                    if (festivos.includes(fechaDia)) {
                        td.classList.add('festivo');
                    } else if (fechaDia.getDay() == 0 || fechaDia.getDay() == 6) {
                        td.classList.add('finde');
                    } else {
                        td.classList.add('lectivo');
                        cont++;
                    }
                } else {
                    td.classList.add('out');
                }
                tr.appendChild(td);
                contaCelda++;



            }
            //rellenar los huecos vacios para que no se descauadre al final
            while (contaCelda < 7) {
                let td = document.createElement('td');
                tr.appendChild(td);
                contaCelda++;
            }
            //metemos fila y la tabla en el contenedor con los meses ants de empezar el siguiente mes
            cuerpo.appendChild(tr);
            tabla.appendChild(cuerpo);
            test.setMonth(test.getMonth() + 1);
            test.setDate(1);



        }
        document.querySelector('.restantes').textContent = cont;
    }
    tablaLectivos();
</script>

</html>